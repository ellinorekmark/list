"use strict";(self.webpackChunklistig_react_ui=self.webpackChunklistig_react_ui||[]).push([[126],{4126:(e,s,t)=>{t.r(s),t.d(s,{default:()=>se});var i=t(5043),n=t(835),r=t(6446),l=t(1637),o=t(9613),a=t(5081),d=t.n(a),c=t(7285),x=t(6879),u=t(5865),h=t(7392),p=t(7555),j=t(3531),m=t(35),g=t(6600),A=t(5316),f=t(3766),y=t(6605),v=t(710),C=t(1906),b=t(9347),w=t(5146),I=t(3193),E=t(7064),L=t(6990),R=t(3471),S=t(579);const k=new x.A;function W(){return null}const T=e=>{let{list:s,updateCopy:t}=e;const{loginDetails:n}=(0,i.useContext)(o.c),[l,a]=(0,i.useState)(""),[d,c]=(0,i.useState)("VIEWER"),[x,p]=(0,i.useState)(!1),[j,m]=(0,i.useState)(""),g=s.editors||[],A=s.viewers||[],b=(e,i)=>{const n={...s,editors:"EDITOR"===i?[...g,e].filter((e=>!A.includes(e))):g.filter((s=>s!==e)),viewers:"VIEWER"===i?[...A,e].filter((e=>!g.includes(e))):A.filter((s=>s!==e))};console.log("updating users in HandleUsers, ",JSON.stringify(n)),t(n)},T=e=>{const i={...s,editors:g.filter((s=>s!==e)),viewers:A.filter((s=>s!==e))};t(i)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(f.A,{children:[(0,S.jsx)(y.A,{id:"panel-header","aria-controls":"panel-content",sx:{backgroundColor:"primary.main"},children:(0,S.jsx)(r.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,S.jsx)(u.A,{p:1,fontSize:"large",children:"Users"})})}),(0,S.jsxs)(v.A,{children:[(0,S.jsx)("br",{}),g.length>0||A.length>0?(0,S.jsxs)(S.Fragment,{children:[g.map(((e,s)=>(0,S.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",marginBottom:1},children:[(0,S.jsx)(u.A,{sx:{flexGrow:1,marginLeft:2},children:e}),(0,S.jsx)(I.A,{sx:{width:100,marginRight:2},children:(0,S.jsxs)(E.A,{value:"EDITOR",onChange:s=>b(e,s.target.value),children:[(0,S.jsx)(L.A,{value:"EDITOR",children:"Editor"}),(0,S.jsx)(L.A,{value:"VIEWER",children:"Viewer"})]})}),(0,S.jsx)(h.A,{onClick:()=>T(e),color:"error",children:(0,S.jsx)(R.A,{})})]},s))),A.map(((e,s)=>(0,S.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",marginBottom:1},children:[(0,S.jsx)(u.A,{sx:{flexGrow:1,marginLeft:2},children:e}),(0,S.jsx)(I.A,{sx:{width:100,marginRight:2},children:(0,S.jsxs)(E.A,{value:"VIEWER",onChange:s=>b(e,s.target.value),children:[(0,S.jsx)(L.A,{value:"EDITOR",children:"Editor"}),(0,S.jsx)(L.A,{value:"VIEWER",children:"Viewer"})]})}),(0,S.jsx)(h.A,{onClick:()=>T(e),color:"error",children:(0,S.jsx)(R.A,{})})]},s)))]}):(0,S.jsx)(u.A,{sx:{marginLeft:2},children:"No users, only you have access to this list."})]})]}),(0,S.jsxs)(f.A,{children:[(0,S.jsx)(y.A,{id:"panel-header","aria-controls":"panel-content",sx:{backgroundColor:"primary.main"},children:(0,S.jsx)(r.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,S.jsx)(u.A,{p:1,fontSize:"large",children:"Add User"})})}),(0,S.jsxs)(v.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,S.jsx)(I.A,{sx:{maxWidth:350,marginBottom:2},children:(0,S.jsx)(w.A,{inputProps:{maxLength:50},id:"new-item",label:"Username",variant:"outlined",value:l,onChange:e=>a(e.target.value),fullWidth:!0})}),(0,S.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:350},children:[(0,S.jsx)(I.A,{sx:{width:"48%"},children:(0,S.jsxs)(E.A,{defaultValue:"VIEWER",onChange:e=>{c(e.target.value)},inputProps:{name:"role",id:"uncontrolled-native"},sx:{width:"100%"},children:[(0,S.jsx)("option",{value:"VIEWER",children:"Viewer"}),(0,S.jsx)("option",{value:"EDITOR",children:"Editor"})]})}),x?(0,S.jsx)(W,{}):(0,S.jsx)(C.A,{onClick:async()=>{p(!0),m("");try{if(!0===await k.sendPost("user/userExists",{username:l},n)){const e={...s,editors:"EDITOR"===d?[...g,l]:g,viewers:"VIEWER"===d?[...A,l]:A};a(""),c("VIEWER"),t(e)}else m("The username does not exist.")}catch(e){m("An error occurred while checking the username.")}finally{p(!1)}},variant:"outlined",sx:{height:"56px",width:"48%"},children:"Add User"})]}),(0,S.jsx)("br",{}),(0,S.jsxs)(u.A,{color:"error",children:[" ",j]})]})]})]})},D=e=>{let{list:s,updateCopy:t}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(f.A,{children:[(0,S.jsx)(y.A,{id:"panel-header","aria-controls":"panel-content",sx:{backgroundColor:"primary.main"},children:(0,S.jsx)(r.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,S.jsx)(u.A,{p:1,fontSize:"large",children:"List Details"})})}),(0,S.jsxs)(v.A,{children:[(0,S.jsx)("br",{}),(0,S.jsx)(w.A,{inputProps:{maxLength:40},id:"list-title",label:"Title",variant:"outlined",value:s.listInfo.listName,onChange:e=>(e=>{const i={...s,listInfo:{...s.listInfo,listName:e}};t(i)})(e.target.value),fullWidth:!0,sx:{marginBottom:1}}),(0,S.jsx)(w.A,{inputProps:{maxLength:40},id:"list-desc",label:"Description (optional)",variant:"outlined",value:s.listInfo.listDesc,onChange:e=>(e=>{const i={...s,listInfo:{...s.listInfo,listDesc:e}};t(i)})(e.target.value),fullWidth:!0,sx:{marginBottom:1}}),(0,S.jsxs)(I.A,{children:[(0,S.jsx)(u.A,{children:"List type:"}),(0,S.jsxs)(E.A,{value:s.listInfo.type,onChange:e=>{const i={...s,listInfo:{...s.listInfo,type:e.target.value}};t(i)},sx:{width:200,marginBottom:2},children:[(0,S.jsx)(L.A,{value:"BASIC",children:"Normal"}),(0,S.jsx)(L.A,{value:"CHECK",children:"Checklist"})]})]})]})]}),(0,S.jsx)(T,{list:s,updateCopy:t})]})};var F=t(3159);const P=new x.A,V=e=>{let{uList:s,updateList:t}=e;const{loginDetails:l,user:a}=(0,i.useContext)(o.c),[d,c]=(0,i.useState)(!1),[x,p]=(0,i.useState)({...s}),[j,w]=(0,i.useState)(!1),I=(0,n.Zp)();function E(){c(!1)}function L(){return s.owner===a.username}return(0,i.useEffect)((()=>{w(L)}),[a]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.A,{variant:"outlined",onClick:function(){c(!0)},children:(0,S.jsx)(F.A,{sx:{p:1}})}),(0,S.jsxs)(m.A,{fullScreen:!0,open:d,onClose:E,children:[(0,S.jsx)(g.A,{children:(0,S.jsx)(r.A,{sx:{paddingTop:2},children:(0,S.jsx)(u.A,{fontSize:"xx-large",sx:{fontFamily:"Garamond",textAlign:"center"},children:"Edit List"})})}),(0,S.jsx)(A.A,{children:(0,S.jsxs)(r.A,{maxWidth:400,sx:{mx:"auto",cursor:"pointer",border:"1px solid #ccc",marginTop:"5px",borderRadius:"5px"},variant:"contained",children:[(0,S.jsx)(D,{list:x,updateCopy:function(e){p(e)}}),j&&(0,S.jsxs)(f.A,{children:[(0,S.jsx)(y.A,{id:"panel-header","aria-controls":"panel-content",sx:{backgroundColor:"primary.main"},children:(0,S.jsx)(r.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,S.jsx)(u.A,{p:1,fontSize:"large",children:"Delete list"})})}),(0,S.jsxs)(v.A,{sx:{justifyContent:"center"},children:[(0,S.jsxs)(u.A,{textAlign:"center",p:1,children:["Warning: ",(0,S.jsx)("br",{}),"Deleting a list cannot be reversed."]}),(0,S.jsx)(C.A,{onClick:async function(){await P.sendDelete("list",s.listInfo.id,l),c(!1),I("/overview")},variant:"contained",sx:{padding:2},color:"error",fullWidth:!0,children:"Delete list"})]})]})]})}),(0,S.jsxs)(b.A,{sx:{justifyContent:"center"},children:[(0,S.jsx)(C.A,{onClick:E,variant:"contained",children:"Cancel"}),(0,S.jsx)(C.A,{onClick:function(){let e=[],i=[];s.editors!==x.editors&&(e=s.editors.filter((e=>!x.editors.includes(e)))),s.viewers!==x.viewers&&(i=s.viewers.filter((e=>!x.viewers.includes(e)))),e.concat(i).forEach((e=>{P.sendPost("user/removeEditor",{user:e},l)})),console.log("This is the updated, copy:",JSON.stringify(x)),t(x),c(!1)},variant:"contained",children:"Save Changes"})]})]})]})};var B=t(5721),O=t(1322),z=t(3851),N=t(8734),G=t(4208),J=t(6581),U=t(4109);const H=e=>{let{uList:s,updateList:t}=e;return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(B.A,{children:s.items.map((e=>{return(0,S.jsxs)(O.Ay,{sx:{cursor:"pointer",border:"1px solid #ccc",marginTop:"5px",borderRadius:"5px"},onClick:()=>(e=>{const i=s.items.map((s=>s.id===e?{...s,status:"1"===s.status?"":"1"}:s));t({...s,items:i})})(e.id),children:[(0,S.jsx)(z.A,{children:(0,S.jsx)(r.A,{children:(i=e.status,"1"===i?(0,S.jsx)(J.A,{}):(0,S.jsx)(U.A,{}))})}),(0,S.jsx)(N.A,{primary:e.item,primaryTypographyProps:{fontSize:"18px"}}),(0,S.jsx)(h.A,{edge:"end",children:(0,S.jsx)(G.A,{})})]},e.id);var i}))})})},_=e=>{let{uList:s}=e;return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(B.A,{children:s.items.map((e=>(0,S.jsxs)(O.Ay,{sx:{cursor:"pointer",border:"1px solid #ccc",marginTop:"5px",borderRadius:"5px",borderColor:"gray"},children:[(0,S.jsx)(z.A,{children:(0,S.jsx)(r.A,{})}),(0,S.jsx)(N.A,{primary:e.item,primaryTypographyProps:{fontSize:"18px"}}),(0,S.jsx)(h.A,{edge:"end",children:(0,S.jsx)(G.A,{})})]},e.id)))})})};var K=t(6893),M=t(635),Y=t(9409),Z=t(155);const q=e=>{let{uList:s,updateList:t}=e;return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(B.A,{children:(0,S.jsx)(M.JY,{onDragEnd:e=>{if(!e.destination)return;const i=e.source.index,n=e.destination.index,r=[...s.items],[l]=r.splice(i,1);r.splice(n,0,l),s.items=r,t(s)},children:(0,S.jsx)(M.gL,{droppableId:"items",children:e=>(0,S.jsxs)(r.A,{ref:e.innerRef,...e.droppableProps,children:[s.items.map(((e,i)=>(0,S.jsx)(M.sx,{index:i,draggableId:e.id+"",children:i=>(0,S.jsxs)(O.Ay,{ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,sx:{cursor:"pointer",border:"1px solid #ccc",marginTop:"5px",borderRadius:"5px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,S.jsx)(z.A,{children:(0,S.jsx)(r.A,{children:(0,S.jsx)(Y.A,{})})}),(0,S.jsx)(N.A,{primary:e.item,primaryTypographyProps:{fontSize:"18px"}}),(0,S.jsx)(h.A,{edge:"end","aria-label":"delete",onClick:()=>(e=>{const i={...s,items:s.items.filter((s=>s.id!==e))};t(i)})(e.id),children:(0,S.jsx)(Z.A,{})})]})},e.id))),e.placeholder]})})})})})};var Q=t(2505);const X=e=>{let{uList:s,updateList:t}=e;const[n,l]=(0,i.useState)("");return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",mt:2},children:[(0,S.jsx)(w.A,{inputProps:{maxLength:33},id:"new-item",label:"New Item",variant:"outlined",value:n,onChange:e=>l(e.target.value),fullWidth:!0,sx:{height:"56px"},InputProps:{sx:{borderTopRightRadius:0,borderBottomRightRadius:0,"& .MuiOutlinedInput-notchedOutline":{borderTopRightRadius:0,borderBottomRightRadius:0},height:"56px"}}}),(0,S.jsx)(C.A,{onClick:()=>{if(""===n.trim())return;const e={listId:s.listInfo.id,item:n},i={...s,items:[...s.items,e]};t(i),l("")},variant:"contained",sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0,height:"56px",minWidth:"56px"},children:(0,S.jsx)(Q.A,{})})]})})},$=e=>{let{uList:s,updateList:t}=e;const{user:n}=(0,i.useContext)(o.c),[l,a]=(0,i.useState)(!0),[d,c]=(0,i.useState)((()=>n.username===s.owner||s.editors.includes(n.username)));return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(r.A,{maxWidth:750,sx:{mx:"auto"},variant:"contained",children:[(0,S.jsxs)(r.A,{children:[(0,S.jsxs)(r.A,{sx:{marginTop:2},children:[(0,S.jsx)(u.A,{fontSize:"xx-large",sx:{fontFamily:"Garamond"},children:s.listInfo.listName}),(0,S.jsx)("br",{})]}),(0,S.jsxs)(r.A,{sx:{display:"grid",border:"1px solid #ccc",borderRadius:2,m:2},children:[(0,S.jsx)(r.A,{sx:{marginBottom:2,gridRow:"1",gridColumn:"1 / 2",m:1},children:(0,S.jsxs)(u.A,{fontSize:"large",sx:{fontFamily:"Garamond",textAlign:"left"},children:[s.listInfo.listDesc,(0,S.jsx)("br",{})]})}),(0,S.jsxs)(r.A,{sx:{gridRow:"1",gridColumn:"3"},children:[(0,S.jsx)(h.A,{variant:"outlined",onClick:()=>{a(!l)},children:l?(0,S.jsx)(p.A,{sx:{p:1}}):(0,S.jsx)(j.A,{sx:{cursor:"pointer",p:1}})}),d&&(0,S.jsx)(V,{uList:s,updateList:t})]}),(0,S.jsx)(u.A,{sx:{gridRow:"2",gridColumn:"1 / 3",textAlign:"left",p:1},children:(()=>{if(s.owner===n.username&&0===s.editors.length&&0===s.viewers.length)return(0,S.jsx)("br",{});{const e=[...s.editors,...s.viewers].join(", "),t=s.owner+", "+e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(K.A,{sx:{verticalAlign:"middle",mr:1}}),t]})}})()})]})]}),l?(0,S.jsx)(r.A,{children:(x=s,"CHECK"===x.listInfo.type?(0,S.jsx)(H,{uList:s,updateList:t}):(0,S.jsx)(_,{uList:s}))}):(0,S.jsx)(q,{uList:s,updateList:t}),(0,S.jsx)(X,{uList:s,updateList:t})]})});var x},ee=new x.A,se=()=>{const{id:e}=(0,n.g)(),{loginDetails:s}=(0,i.useContext)(o.c),[t,a]=(0,i.useState)(!0),[x,h]=(0,i.useState)(null),[p,j]=(0,i.useState)(null);(0,i.useEffect)((()=>{(async()=>{try{const t=await ee.sendGet("list/".concat(e),s);h(t)}catch(t){console.error("Error fetching data",t)}finally{a(!1)}})();const t=new(d())("http://localhost:8080/ws"),i=new c.K({webSocketFactory:()=>t,onConnect:()=>{console.log("Connected to WebSocket"),i.subscribe("/topic/list/".concat(e),(e=>{const s=JSON.parse(e.body);h((e=>({...e,items:e.items.map((e=>e.id===s.id?s:e))})))}))},onStompError:e=>{console.error("Broker reported error: "+e.headers.message),console.error("Additional details: "+e.body)}});return t.onclose=function(e){console.error("WebSocket is closed now.",e)},t.onerror=function(e){console.error("WebSocket error observed:",e)},i.activate(),j(i),()=>{i&&i.connected&&i.deactivate()}}),[s]);return(0,S.jsx)(S.Fragment,{children:t?(0,S.jsxs)(r.A,{children:[(0,S.jsx)(l.A,{}),(0,S.jsx)(u.A,{children:"Loading List"})]}):(0,S.jsx)($,{uList:x,updateList:s=>{h(s),p&&p.connected&&(p.publish("/app/list/".concat(e),{},JSON.stringify(s)),console.log("Sent update to WebSocket"))}})})}}}]);
//# sourceMappingURL=126.f33ed47b.chunk.js.map